<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Airway smooth muscle cells</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Airway smooth muscle cells}
-->

<h1>Airway smooth muscle cells</h1>

<p>Here we provide the code which was used to contruct the
<em>RangedSummarizedExperiment</em> object of the <em>airway</em> experiment data
package. The experiment citation is:</p>

<p>Himes BE, Jiang X, Wagner P, Hu R, Wang Q, Klanderman B, Whitaker RM,
Duan Q, Lasky-Su J, Nikolos C, Jester W, Johnson M, Panettieri R Jr,
Tantisira KG, Weiss ST, Lu Q. &ldquo;RNA-Seq Transcriptome Profiling
Identifies CRISPLD2 as a Glucocorticoid Responsive Gene that Modulates
Cytokine Function in Airway Smooth Muscle Cells.&rdquo; PLoS One. 2014 Jun
13;9(6):e99625.
PMID: <a href="http://www.ncbi.nlm.nih.gov/pubmed/24926665">24926665</a>.
GEO: <a href="http://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE52778">GSE52778</a>.</p>

<p>From the abstract, a brief description of the RNA-Seq experiment on
airway smooth muscle (ASM) cell lines: &ldquo;Using RNA-Seq, a
high-throughput sequencing method, we characterized transcriptomic
changes in four primary human ASM cell lines that were treated with
dexamethasone - a potent synthetic glucocorticoid (1 micromolar for 18
hours).&rdquo;</p>

<p><strong>Note:</strong> in version 1.6, the package was updated to include two
samples, SRR1039508 and SRR1039509, quantified using Salmon, in order
to demonstrate the tximport/tximeta Bioconductor packages. For details
on the quantification steps for these files, consult the airway2
package: <a href="https://github.com/mikelove/airway2">https://github.com/mikelove/airway2</a>. Another dataset,
labelled <code>gse</code> was added to the <em>airway</em> package, which contains the
<em>SummarizedExperiment</em> object obtained after loading quantification
data for all 8 samples into R/Bioconductor using the <em>tximeta</em>
package, first running <code>tximeta</code> and then <code>summarizeToGene</code>.</p>

<h1>Obtaining sample information from GEO</h1>

<p>The following code chunk obtains the sample information from the
series matrix file downloaded from GEO. The columns are then parsed
and new columns with shorter names and factor levels are added.</p>

<pre><code class="r">suppressPackageStartupMessages( library( &quot;GEOquery&quot; ) )
suppressPackageStartupMessages( library( &quot;airway&quot; ) )
dir &lt;- system.file(&quot;extdata&quot;,package=&quot;airway&quot;)
geofile &lt;- file.path(dir, &quot;GSE52778_series_matrix.txt&quot;)
gse &lt;- getGEO(filename=geofile)
</code></pre>

<pre><code>## Parsed with column specification:
## cols(
##   ID_REF = col_character(),
##   GSM1275862 = col_character(),
##   GSM1275863 = col_character(),
##   GSM1275864 = col_character(),
##   GSM1275865 = col_character(),
##   GSM1275866 = col_character(),
##   GSM1275867 = col_character(),
##   GSM1275868 = col_character(),
##   GSM1275869 = col_character(),
##   GSM1275870 = col_character(),
##   GSM1275871 = col_character(),
##   GSM1275872 = col_character(),
##   GSM1275873 = col_character(),
##   GSM1275874 = col_character(),
##   GSM1275875 = col_character(),
##   GSM1275876 = col_character(),
##   GSM1275877 = col_character()
## )
</code></pre>

<pre><code>## File stored at:
</code></pre>

<pre><code>## /tmp/RtmpRC7Drb/GPL11154.soft
</code></pre>

<pre><code class="r">pdata &lt;- pData(gse)[,grepl(&quot;ch1&quot;,names(pData(gse)))]
names(pdata) &lt;- c(&quot;treatment&quot;,&quot;tissue&quot;,&quot;ercc_mix&quot;,&quot;cell&quot;,&quot;celltype&quot;)
pdataclean &lt;- data.frame(treatment=sub(&quot;treatment: (.*)&quot;,&quot;\\1&quot;,pdata$treatment),
                         cell=sub(&quot;cell line: (.*)&quot;,&quot;\\1&quot;,pdata$cell),
                         row.names=rownames(pdata))
pdataclean$dex &lt;- ifelse(grepl(&quot;Dex&quot;,pdataclean$treatment),&quot;trt&quot;,&quot;untrt&quot;)
pdataclean$albut &lt;- ifelse(grepl(&quot;Albut&quot;,pdataclean$treatment),&quot;trt&quot;,&quot;untrt&quot;)
pdataclean$SampleName &lt;- rownames(pdataclean)
pdataclean$treatment &lt;- NULL
</code></pre>

<p>The information which connects the sample information from GEO with
the SRA run id is downloaded from
<a href="http://www.ncbi.nlm.nih.gov/sra/?term=SRP033351">SRA</a> using the
<strong>Send to: File</strong> button.</p>

<pre><code class="r">srafile &lt;- file.path(dir, &quot;SraRunInfo_SRP033351.csv&quot;)
srp &lt;- read.csv(srafile)
srpsmall &lt;- srp[,c(&quot;Run&quot;,&quot;avgLength&quot;,&quot;Experiment&quot;,&quot;Sample&quot;,&quot;BioSample&quot;,&quot;SampleName&quot;)]
</code></pre>

<p>These two <em>data.frames</em> are merged and then we subset to only the
samples not treated with albuterol (these samples were not included in
the analysis of the publication).</p>

<pre><code class="r">coldata &lt;- merge(pdataclean, srpsmall, by=&quot;SampleName&quot;)
rownames(coldata) &lt;- coldata$Run
coldata &lt;- coldata[coldata$albut == &quot;untrt&quot;,]
coldata$albut &lt;- NULL
coldata
</code></pre>

<pre><code>##            SampleName                                     cell   dex
## SRR1039508 GSM1275862 tissue: human airway smooth muscle cells untrt
## SRR1039509 GSM1275863 tissue: human airway smooth muscle cells untrt
## SRR1039510 GSM1275864 tissue: human airway smooth muscle cells untrt
## SRR1039511 GSM1275865 tissue: human airway smooth muscle cells untrt
## SRR1039512 GSM1275866 tissue: human airway smooth muscle cells untrt
## SRR1039513 GSM1275867 tissue: human airway smooth muscle cells untrt
## SRR1039514 GSM1275868 tissue: human airway smooth muscle cells untrt
## SRR1039515 GSM1275869 tissue: human airway smooth muscle cells untrt
## SRR1039516 GSM1275870 tissue: human airway smooth muscle cells untrt
## SRR1039517 GSM1275871 tissue: human airway smooth muscle cells untrt
## SRR1039518 GSM1275872 tissue: human airway smooth muscle cells untrt
## SRR1039519 GSM1275873 tissue: human airway smooth muscle cells untrt
## SRR1039520 GSM1275874 tissue: human airway smooth muscle cells untrt
## SRR1039521 GSM1275875 tissue: human airway smooth muscle cells untrt
## SRR1039522 GSM1275876 tissue: human airway smooth muscle cells untrt
## SRR1039523 GSM1275877 tissue: human airway smooth muscle cells untrt
##                   Run avgLength Experiment    Sample    BioSample
## SRR1039508 SRR1039508       126  SRX384345 SRS508568 SAMN02422669
## SRR1039509 SRR1039509       126  SRX384346 SRS508567 SAMN02422675
## SRR1039510 SRR1039510       126  SRX384347 SRS508570 SAMN02422668
## SRR1039511 SRR1039511       126  SRX384348 SRS508569 SAMN02422667
## SRR1039512 SRR1039512       126  SRX384349 SRS508571 SAMN02422678
## SRR1039513 SRR1039513        87  SRX384350 SRS508572 SAMN02422670
## SRR1039514 SRR1039514       126  SRX384351 SRS508574 SAMN02422681
## SRR1039515 SRR1039515       114  SRX384352 SRS508573 SAMN02422671
## SRR1039516 SRR1039516       120  SRX384353 SRS508575 SAMN02422682
## SRR1039517 SRR1039517       126  SRX384354 SRS508576 SAMN02422673
## SRR1039518 SRR1039518       126  SRX384355 SRS508578 SAMN02422679
## SRR1039519 SRR1039519       107  SRX384356 SRS508577 SAMN02422672
## SRR1039520 SRR1039520       101  SRX384357 SRS508579 SAMN02422683
## SRR1039521 SRR1039521        98  SRX384358 SRS508580 SAMN02422677
## SRR1039522 SRR1039522       125  SRX384359 SRS508582 SAMN02422680
## SRR1039523 SRR1039523       126  SRX384360 SRS508581 SAMN02422674
</code></pre>

<p>Finally, the sample table was saved to a CSV file for future
reference. This file is included in the <code>inst/extdata</code> directory of
this package.</p>

<pre><code class="r">write.csv(coldata, file=&quot;sample_table.csv&quot;)
</code></pre>

<h1>Downloading FASTQ files from SRA</h1>

<p>A file containing the SRA run numbers was created: <code>files</code>. This
file was used to download the sequenced reads from the SRA using
<code>wget</code>. The following command was used to extract the FASTQ file from
the <code>.sra</code> files, using the
<a href="http://www.ncbi.nlm.nih.gov/books/NBK47540/">SRA Toolkit</a> </p>

<pre><code>cat files | parallel -j 7 fastq-dump --split-files {}.sra
</code></pre>

<h1>Aligning reads</h1>

<p>The reads were aligned using the 
<a href="https://code.google.com/p/rna-star/">STAR read aligner</a> 
to GRCh37 using the annotations from Ensembl release 75.</p>

<pre><code>for f in `cat files`; do STAR --genomeDir ../STAR/ENSEMBL.homo_sapiens.release-75 \
--readFilesIn fastq/$f\_1.fastq fastq/$f\_2.fastq \
--runThreadN 12 --outFileNamePrefix aligned/$f.; done
</code></pre>

<p><a href="http://samtools.sourceforge.net/">SAMtools</a> was used to generate BAM files.</p>

<pre><code>cat files | parallel -j 7 samtools view -bS aligned/{}.Aligned.out.sam -o aligned/{}.bam
</code></pre>

<h1>Counting reads</h1>

<p>A transcript database for the homo sapiens Ensembl genes was obtained
from Biomart.</p>

<pre><code class="r">library( &quot;GenomicFeatures&quot; )
txdb &lt;- makeTranscriptDbFromBiomart( biomart=&quot;ensembl&quot;, dataset=&quot;hsapiens_gene_ensembl&quot;)
exonsByGene &lt;- exonsBy( txdb, by=&quot;gene&quot; )
</code></pre>

<p>The BAM files were specified using the <code>SRR</code> id from the SRA. A yield
size of 2 million reads was used to cap the memory used during
read counting.</p>

<pre><code class="r">sampleTable &lt;- read.csv( &quot;sample_table.csv&quot;, row.names=1 )
fls &lt;- file.path(&quot;aligned&quot;,rownames(sampleTable), &quot;.bam&quot;)
library( &quot;Rsamtools&quot; )
bamLst &lt;- BamFileList( fls, yieldSize=2000000 )
</code></pre>

<p>The following <code>summarizeOverlaps</code> call distributed the 8 paired-end
BAM files to 8 workers. This used a maximum of 16 Gb per worker and
the time elapsed was 50 minutes.</p>

<pre><code class="r">library( &quot;BiocParallel&quot; )
register( MulticoreParam( workers=8 ) )
library( &quot;GenomicAlignments&quot; )
airway &lt;- summarizeOverlaps( features=exonsByGene, reads=bamLst,
                            mode=&quot;Union&quot;, singleEnd=FALSE,
                            ignore.strand=TRUE, fragments=TRUE )
</code></pre>

<p>The sample information was then added as column data.</p>

<pre><code class="r">colData(airway) &lt;- DataFrame( sampleTable )
</code></pre>

<p>Finally, we attached the <code>MIAME</code> information using the Pubmed ID.</p>

<pre><code class="r">library( &quot;annotate&quot; )
miame &lt;- list(pmid2MIAME(&quot;24926665&quot;))
miame[[1]]@url &lt;- &quot;http://www.ncbi.nlm.nih.gov/pubmed/24926665&quot;
# because R&#39;s CHECK doesn&#39;t like non-ASCII characters in data objects
# or in vignettes. the actual char was used in the first argument
miame[[1]]@abstract &lt;- gsub(&quot;micro&quot;,&quot;micro&quot;,abstract(miame[[1]]))
miame[[1]]@abstract &lt;- gsub(&quot;beta&quot;,&quot;beta&quot;,abstract(miame[[1]]))
metadata(airway) &lt;- miame
save(airway, file=&quot;airway.RData&quot;)
</code></pre>

<h1>Information on the RangedSummarizedExperiment</h1>

<p>Below we print out some basic summary statistics on the <code>airway</code>
object which is provided by this experiment data package.</p>

<pre><code class="r">library(&quot;airway&quot;)
data(airway)
airway
</code></pre>

<pre><code>## class: RangedSummarizedExperiment 
## dim: 64102 8 
## metadata(1): &#39;&#39;
## assays(1): counts
## rownames(64102): ENSG00000000003 ENSG00000000005 ... LRG_98 LRG_99
## rowData names(0):
## colnames(8): SRR1039508 SRR1039509 ... SRR1039520 SRR1039521
## colData names(9): SampleName cell ... Sample BioSample
</code></pre>

<pre><code class="r">as.data.frame(colData(airway))
</code></pre>

<pre><code>##            SampleName    cell   dex albut        Run avgLength Experiment
## SRR1039508 GSM1275862  N61311 untrt untrt SRR1039508       126  SRX384345
## SRR1039509 GSM1275863  N61311   trt untrt SRR1039509       126  SRX384346
## SRR1039512 GSM1275866 N052611 untrt untrt SRR1039512       126  SRX384349
## SRR1039513 GSM1275867 N052611   trt untrt SRR1039513        87  SRX384350
## SRR1039516 GSM1275870 N080611 untrt untrt SRR1039516       120  SRX384353
## SRR1039517 GSM1275871 N080611   trt untrt SRR1039517       126  SRX384354
## SRR1039520 GSM1275874 N061011 untrt untrt SRR1039520       101  SRX384357
## SRR1039521 GSM1275875 N061011   trt untrt SRR1039521        98  SRX384358
##               Sample    BioSample
## SRR1039508 SRS508568 SAMN02422669
## SRR1039509 SRS508567 SAMN02422675
## SRR1039512 SRS508571 SAMN02422678
## SRR1039513 SRS508572 SAMN02422670
## SRR1039516 SRS508575 SAMN02422682
## SRR1039517 SRS508576 SAMN02422673
## SRR1039520 SRS508579 SAMN02422683
## SRR1039521 SRS508580 SAMN02422677
</code></pre>

<pre><code class="r">summary(colSums(assay(airway))/1e6)
</code></pre>

<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   15.16   19.05   20.90   21.94   24.67   30.82
</code></pre>

<pre><code class="r">metadata(rowRanges(airway))
</code></pre>

<pre><code>## $genomeInfo
## $genomeInfo$`Db type`
## [1] &quot;TranscriptDb&quot;
## 
## $genomeInfo$`Supporting package`
## [1] &quot;GenomicFeatures&quot;
## 
## $genomeInfo$`Data source`
## [1] &quot;BioMart&quot;
## 
## $genomeInfo$Organism
## [1] &quot;Homo sapiens&quot;
## 
## $genomeInfo$`Resource URL`
## [1] &quot;www.biomart.org:80&quot;
## 
## $genomeInfo$`BioMart database`
## [1] &quot;ensembl&quot;
## 
## $genomeInfo$`BioMart database version`
## [1] &quot;ENSEMBL GENES 75 (SANGER UK)&quot;
## 
## $genomeInfo$`BioMart dataset`
## [1] &quot;hsapiens_gene_ensembl&quot;
## 
## $genomeInfo$`BioMart dataset description`
## [1] &quot;Homo sapiens genes (GRCh37.p13)&quot;
## 
## $genomeInfo$`BioMart dataset version`
## [1] &quot;GRCh37.p13&quot;
## 
## $genomeInfo$`Full dataset`
## [1] &quot;yes&quot;
## 
## $genomeInfo$`miRBase build ID`
## [1] NA
## 
## $genomeInfo$transcript_nrow
## [1] &quot;215647&quot;
## 
## $genomeInfo$exon_nrow
## [1] &quot;745593&quot;
## 
## $genomeInfo$cds_nrow
## [1] &quot;537555&quot;
## 
## $genomeInfo$`Db created by`
## [1] &quot;GenomicFeatures package from Bioconductor&quot;
## 
## $genomeInfo$`Creation time`
## [1] &quot;2014-07-10 14:55:55 -0400 (Thu, 10 Jul 2014)&quot;
## 
## $genomeInfo$`GenomicFeatures version at creation time`
## [1] &quot;1.17.9&quot;
## 
## $genomeInfo$`RSQLite version at creation time`
## [1] &quot;0.11.4&quot;
## 
## $genomeInfo$DBSCHEMAVERSION
## [1] &quot;1.0&quot;
</code></pre>

<h1>Session information</h1>

<pre><code class="r">sessionInfo()
</code></pre>

<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 18.04.3 LTS
## 
## Matrix products: default
## BLAS:   /home/biocbuild/bbs-3.10-bioc/R/lib/libRblas.so
## LAPACK: /home/biocbuild/bbs-3.10-bioc/R/lib/libRlapack.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=C              
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats4    parallel  stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] airway_1.6.0                SummarizedExperiment_1.16.0
##  [3] DelayedArray_0.12.0         BiocParallel_1.20.0        
##  [5] matrixStats_0.55.0          GenomicRanges_1.38.0       
##  [7] GenomeInfoDb_1.22.0         IRanges_2.20.0             
##  [9] S4Vectors_0.24.0            GEOquery_2.54.0            
## [11] Biobase_2.46.0              BiocGenerics_0.32.0        
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.2             pillar_1.4.2           compiler_3.6.1        
##  [4] XVector_0.26.0         zlibbioc_1.32.0        bitops_1.0-6          
##  [7] tools_3.6.1            zeallot_0.1.0          lattice_0.20-38       
## [10] evaluate_0.14          lifecycle_0.1.0        tibble_2.1.3          
## [13] pkgconfig_2.0.3        rlang_0.4.1            Matrix_1.2-17         
## [16] xfun_0.10              GenomeInfoDbData_1.2.2 dplyr_0.8.3           
## [19] stringr_1.4.0          knitr_1.25             xml2_1.2.2            
## [22] vctrs_0.2.0            hms_0.5.2              grid_3.6.1            
## [25] tidyselect_0.2.5       glue_1.3.1             R6_2.4.0              
## [28] limma_3.42.0           tidyr_1.0.0            readr_1.3.1           
## [31] purrr_0.3.3            magrittr_1.5           ellipsis_0.3.0        
## [34] backports_1.1.5        assertthat_0.2.1       stringi_1.4.3         
## [37] RCurl_1.95-4.12        crayon_1.3.4
</code></pre>

</body>

</html>

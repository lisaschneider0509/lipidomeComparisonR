labs(title = title) +
# scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
my_theme # sets general apperance, label size and justification
if(out_path != 1){
print(paste("Saving parallel coordinates plot to ", out_path, "_screePlot.png", sep = ""))
ggsave(paste(out_path, "_screePlot.png", sep = ""),
plot = scree)
}
else{
scree
}
}
scree_factoextra(pca_iris, title = "Scree plot iris")
dir.create(paste(getwd(), "/examples", sep = ""), showWarnings = FALSE)
dir <- paste(getwd(), "/examples/iris", sep = "")
scree_factoextra(pca_iris, title = "Scree plot iris", out_path = dir)
biplot_factoextra(pca_iris)
biplot_factoextra <- function(prcomp_element, groups = FALSE, ellipse = TRUE){
factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
) +
scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
}
biplot_factoextra(pca_iris)
biplot_factoextra <- function(prcomp_element, groups = NULL, ellipse = TRUE){
factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
) +
scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
}
biplot_factoextra(pca_iris)
biplot_factoextra <- function(prcomp_element, groups = NULL, ellipse = TRUE){
factoextra::fviz_pca_biplot(prcomp_element,
## color by group
# habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
) +
scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
}
biplot_factoextra(pca_iris)
biplot_factoextra <- function(prcomp_element, groups = 1, ellipse = TRUE){
factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
) +
scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
}
biplot_factoextra(pca_iris)
biplot_factoextra <- function(prcomp_element, groups = "none", ellipse = TRUE){
factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups,
# a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
) +
scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
}
biplot_factoextra(pca_iris)
pca_iris
biplot_factoextra(pca_iris, groups = iris$Species)
summarry(pca_iris)
summarry(pca_iris)
summarry(pca_iris)
summary(pca_iris)
summarry(pca_iris)
pca_iris$X
pca_iris$x
pca_iris$sdev
pca_iris$sdev
pca_iris$rotation
pca_iris$scale
scree_factoextra(lipid_pca)
scree_base(lipid_pca)
biplot_factoextra(lipid_pca, groups)
pca_iris <- prcomp(select_if(iris, is.numeric))
groups <- iris$Species
biplot_factoextra(pca_iris)
biplot_factoextra(pca_iris, groups = groups)
groups
pca_iris <- prcomp(select_if(iris, is.numeric))
groups <- c(iris$Species)
biplot_factoextra(pca_iris)
biplot_factoextra(pca_iris, groups = groups)
groups <- wd$treatment
groups
iris_groups <- c(iris$Species)
iris_groups
iris$Species
iris_groups <- iris$Species
iris$Species
iris_groups
iris_groups <- iris$Species
biplot_factoextra(pca_iris, groups = groups)
pca_iris <- prcomp(iris)
factoextra::fviz_pca_biplot(pca_iris,
## color by group
habillage = iris_groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = TRUE,
ellipse.type = "confidence",
## legend
legend.title = "Groups")
biplot_factoextra <- function(prcomp_element, groups = "none", ellipse = TRUE){
factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
) +
scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
}
pca_iris <- prcomp(select_if(iris, is.numeric))
iris_groups <- iris$Species
biplot_factoextra(pca_iris)
biplot_factoextra(pca_iris, groups = groups)
biplot_factoextra <- function(prcomp_element, groups = "none", ellipse = TRUE){
factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
)
# +
#   scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
#   scale_color_viridis(discrete = TRUE) +
#   scale_fill_viridis(discrete = TRUE) +
#   my_theme
}
biplot_factoextra <- function(prcomp_element, groups = "none", ellipse = TRUE){
factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
)
# +
#   scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
#   scale_color_viridis(discrete = TRUE) +
#   scale_fill_viridis(discrete = TRUE) +
#   my_theme
}
biplot_factoextra(pca_iris, groups = groups)
biplot_factoextra <- function(prcomp_element, groups = "none", ellipse = TRUE){
factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = iris_groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
)
# +
#   scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
#   scale_color_viridis(discrete = TRUE) +
#   scale_fill_viridis(discrete = TRUE) +
#   my_theme
}
biplot_factoextra(pca_iris, groups = groups)
biplot_factoextra <- function(prcomp_element, groups = "none", ellipse = TRUE){
print(groups)
factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
)
# +
#   scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
#   scale_color_viridis(discrete = TRUE) +
#   scale_fill_viridis(discrete = TRUE) +
#   my_theme
}
biplot_factoextra(pca_iris, groups = groups)
biplot_factoextra(pca_iris, groups = iris_groups)
biplot_factoextra <- function(prcomp_element, groups = "none", ellipse = TRUE){
biplot <- factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
)
+
scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
biplot
}
biplot_factoextra(pca_iris, groups = iris_groups)
biplot_factoextra <- function(prcomp_element, groups = "none", ellipse = TRUE){
biplot <- factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
)   +
scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
biplot
}
biplot_factoextra(pca_iris, groups = iris_groups)
biplot_factoextra <- function(prcomp_element, groups = "none", ellipse = TRUE){
biplot <- factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
)   +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
biplot
}
biplot_factoextra(pca_iris, groups = iris_groups)
biplot_factoextra(lipid_pca, groups)
biplot_factoextra <- function(prcomp_element, groups = "none", ellipse = TRUE){
biplot <- factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
)   +
# scale_shape_manual(values = rep(20, nlevels(wd$treatment), size = 1)) +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
biplot
}
biplot_factoextra(lipid_pca, groups)
biplot_factoextra <- function(prcomp_element,
groups = "none",
ellipse = TRUE,
loadings = TRUE){
biplot <- factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
)   +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
biplot
}
biplot_factoextra(pca_iris)
biplot_factoextra <- function(prcomp_element,
groups = "none",
ellipse = FALSE,
loadings = TRUE){
biplot <- factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "confidence",
## legend
legend.title = "Groups"
)   +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
biplot
}
biplot_factoextra(pca_iris, groups = iris_groups)
biplot_factoextra(pca_iris)
biplot_factoextra(pca_iris, groups = iris_groups, ellipse = TRUE, loadings = FALSE)
biplot_factoextra <- function(prcomp_element,
groups = "none",
ellipse = FALSE,
loadings = TRUE){
biplot <- factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "norm",
## legend
legend.title = "Groups"
)   +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
biplot
}
biplot_factoextra(pca_iris, groups = iris_groups, ellipse = TRUE, loadings = FALSE)
biplot_factoextra(lipid_pca, groups)
biplot_factoextra(lipid_pca, groups, ellipse = TRUE, loadings = FALSE)
biplot_factoextra(pca_iris)
biplot_factoextra(pca_iris, groups = iris_groups, ellipse = TRUE, loadings = FALSE)
pca_iris <- prcomp(select_if(iris, is.numeric))
iris_groups <- iris$Species
biplot_factoextra(pca_iris)
biplot_factoextra(pca_iris,
groups = iris_groups,
ellipse = TRUE,
loadings = FALSE)
\dontrun
dir.create(paste(getwd(), "/examples", sep = ""), showWarnings = FALSE)
dir <- paste(getwd(), "/examples/iris", sep = "")
biplot_factoextra(pca_iris,
groups = iris_groups,
ellipse = TRUE,
loadings = FALSE,
out_path = dir)
#'                   ellipse = TRUE,
#'                   loadings = FALSE)
#' \dontrun
#' dir.create(paste(getwd(), "/examples", sep = ""), showWarnings = FALSE)
#' dir <- paste(getwd(), "/examples/iris", sep = "")
#' biplot_factoextra(pca_iris,
#'                  groups = iris_groups,
#'                  ellipse = TRUE,
#'                  loadings = FALSE,
#'                  out_path = dir)
biplot_factoextra <- function(prcomp_element,
groups = "none",
ellipse = FALSE,
loadings = TRUE,
out_path = 1){
biplot <- factoextra::fviz_pca_biplot(prcomp_element,
## color by group
habillage = groups, # a vector of groups by whicht to color
## labels
label = "var",
labelsize = 2,
repel = TRUE, # labels do not overlap
col.var = "grey40",
## ellipses
addEllipses = ellipse,
ellipse.type = "norm",
## legend
legend.title = "Groups")   +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
my_theme
if(out_path != 1){
print(paste("Saving plot to ", out_path, "_biplot.png", sep = ""))
ggsave(paste(out_path, "_biplot.png", sep = ""),
plot = biplot)
}
else{
biplot()
}
}
biplot_factoextra(pca_iris,
groups = iris_groups,
ellipse = TRUE,
loadings = FALSE,
out_path = dir)

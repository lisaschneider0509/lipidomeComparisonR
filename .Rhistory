limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold)
volcano <- ggplot(data = new_volcano_df, aes(x = x, y = -1*log10(y), col = threshold)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance",
limits = c(-limits, limits))
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = NULL,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold <- y < significance
}
else if(color_by == "foldchange"){
threshold <- x < foldchange
}
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold)
volcano <- ggplot(data = new_volcano_df, aes(x = x, y = -1*log10(y), col = threshold)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance",
limits = c(-1, 1))
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = NULL,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold <- y < significance
}
else if(color_by == "foldchange"){
threshold <- x < foldchange
}
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold)
volcano <- ggplot(data = new_volcano_df, aes(x = x, y = -1*log10(y), col = threshold)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = NULL,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold <- y < significance
}
else if(color_by == "foldchange"){
threshold <- x < foldchange
}
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold)
volcano <- ggplot(data = new_volcano_df, aes(x = x, y = -1*log10(y), col = threshold)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_x_continuous(limits = c(-1, 1)) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = NULL,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold <- y < significance
}
else if(color_by == "foldchange"){
threshold <- x < foldchange
}
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold)
volcano <- ggplot(data = new_volcano_df, aes(x = x, y = -1*log10(y), col = threshold)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_x_continuous(limits = c(-1*limits, limits)) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = NULL,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold_col <- y < significance
threshold_shape <- x < foldchange
}
else if(color_by == "foldchange"){
threshold_col <- x < foldchange
threshold_shape <- y < significance
}
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold_col, threshold_shape)
volcano <- ggplot(data = new_volcano_df,
aes(x = x, y = -1*log10(y),
col = threshold_col,
shape = threshold_shape)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_x_continuous(limits = c(-1*limits, limits)) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = NULL,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold_col <- y < significance
threshold_shape <- x < foldchange
}
else if(color_by == "foldchange"){
threshold_col <- x < foldchange
threshold_shape <- y < significance
}
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold_col, threshold_shape)
volcano <- ggplot(data = new_volcano_df,
aes(x = x, y = -1*log10(y),
col = threshold_col,
shape = threshold_col)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_x_continuous(limits = c(-1*limits, limits)) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = NULL,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold_col <- y < significance
threshold_shape <- x < foldchange
}
else if(color_by == "foldchange"){
threshold_col <- x < foldchange
threshold_shape <- y < significance
}
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold_col)
volcano <- ggplot(data = new_volcano_df,
aes(x = x, y = -1*log10(y),
col = threshold_col,
shape = threshold_col)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_x_continuous(limits = c(-1*limits, limits)) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = NULL,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold_col <- y < significance
threshold_shape <- x < foldchange
}
else if(color_by == "foldchange"){
threshold_col <- x < foldchange
threshold_shape <- y < significance
}
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold_col)
volcano <- ggplot(data = new_volcano_df,
aes(x = x, y = -1*log10(y),
col = threshold_col,
shape = threshold_shape)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_x_continuous(limits = c(-1*limits, limits)) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
threshold_shape <- x < foldchange
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = NULL,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold_col <- y < significance
threshold_shape <- x < foldchange
}
else if(color_by == "foldchange"){
threshold_col <- x < foldchange
threshold_shape <- y < significance
}
print(threshold_shape)
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold_col)
volcano <- ggplot(data = new_volcano_df,
aes(x = x, y = -1*log10(y),
col = threshold_col,
shape = threshold_shape)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_x_continuous(limits = c(-1*limits, limits)) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = 0.05,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold_col <- y < significance
threshold_shape <- x < foldchange
}
else if(color_by == "foldchange"){
threshold_col <- x < foldchange
threshold_shape <- y < significance
}
print(threshold_shape)
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold_col)
volcano <- ggplot(data = new_volcano_df,
aes(x = x, y = -1*log10(y),
col = threshold_col,
shape = threshold_shape)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_x_continuous(limits = c(-1*limits, limits)) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = 0.05,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold_col <- y < significance
threshold_shape <- abs(x) < foldchange
}
else if(color_by == "foldchange"){
threshold_col <- x < foldchange
threshold_shape <- y < significance
}
print(threshold_shape)
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold_col)
volcano <- ggplot(data = new_volcano_df,
aes(x = x, y = -1*log10(y),
col = threshold_col,
shape = threshold_shape)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_x_continuous(limits = c(-1*limits, limits)) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = 0.05,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold_col <- y < significance
threshold_shape <- abs(x) < foldchange
}
else if(color_by == "foldchange"){
threshold_col <- abs(x) < foldchange
threshold_shape <- y < significance
}
print(threshold_shape)
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold_col)
volcano <- ggplot(data = new_volcano_df,
aes(x = x, y = -1*log10(y),
col = threshold_col,
shape = threshold_shape)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
geom_vline(xintercept = -1*foldchange,
linetype = "dashed",
colour = "grey40") +
geom_vline(xintercept = foldchange,
linetype = "dashed",
colour = "grey40")
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_x_continuous(limits = c(-1*limits, limits)) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = 0.05,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold_col <- y < significance
threshold_shape <- abs(x) < foldchange
}
else if(color_by == "foldchange"){
threshold_col <- abs(x) < foldchange
threshold_shape <- y < significance
}
print(threshold_shape)
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold_col)
volcano <- ggplot(data = new_volcano_df,
aes(x = x, y = -1*log10(y),
col = threshold_col,
shape = threshold_shape)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
geom_vline(xintercept = -1*foldchange,
linetype = "dashed",
colour = "grey40") +
geom_vline(xintercept = foldchange,
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_x_continuous(limits = c(-1*limits, limits)) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
volcano_plot <- function(volcano_df,
x, y,
significance = 0.05,
foldchange = 0.05,
color_by = "significance",
title = "Volcano plot",
x_lab = "log2Fold", y_lab = "-log10(p-value)"){
if(color_by == "significance"){
threshold_col <- y < significance
threshold_shape <- abs(x) < foldchange
}
else if(color_by == "foldchange"){
threshold_col <- abs(x) < foldchange
threshold_shape <- y < significance
}
print(threshold_shape)
limits <- max(-1*min(x), max(x))
new_volcano_df <- cbind(volcano_df, threshold_col)
volcano <- ggplot(data = new_volcano_df,
aes(x = x, y = -1*log10(y),
col = threshold_col,
# shape = threshold_shape
)) +
geom_point() +
geom_hline(yintercept = -1*log10(significance),
linetype = "dashed",
colour = "grey40") +
geom_vline(xintercept = -1*foldchange,
linetype = "dashed",
colour = "grey40") +
geom_vline(xintercept = foldchange,
linetype = "dashed",
colour = "grey40") +
labs(title = title) +
xlab(x_lab) + ylab(y_lab) +
scale_x_continuous(limits = c(-1*limits, limits)) +
scale_color_viridis_d(begin = 0,
end = 0.8,
labels = c("not significant", "significant"),
name = "Significance")
volcano
}
volcano_plot(new_volcano_df, new_volcano_df$log2_foldchange, new_volcano_df$p_values, 0.05)
